var gkSound=function(){var g,h,a=[],b=[],c=[],d=1,e=null,i='<div class="btnImage" style="left:0"></div>',j='<div class="btnImage" style="left:-100%"></div>',k=function(){document.body.innerHTML+='<div id="sounds" style="display:none"></div>'},m=function(){(""!=localStorage.musicStatus||null!=localStorage.musicStatus)&&("mute"==localStorage.musicStatus?(gkSound.stopAllSounds(),document.getElementById(g).innerHTML=j,h=!1):(localStorage.musicStatus="on",document.getElementById(g).innerHTML=i,h=!0))},n=function(c){for(var d=!1,e=a.length-1;e>=0;e--)if(a[e].id==c){d=!0;break}for(var e=b.length-1;e>=0;e--)if(b[e].id==c){d=!0;break}return d},o=function(a){var b,c,d;return d=1==gkSound.hasMP3Support()?".mp3":".ogg",-1!=a.search(".mp3")?(c=a.split(".mp3"),d=".mp3"):-1!=a.search(".ogg")?(c=a.split(".ogg"),d=".ogg"):c=null,b=null!=c?c[0]+d+(c[1]?c[1]:""):a+d};return{init:function(a,b){k(),1==a?(void 0==b?a():g=b,document.getElementById(g).addEventListener("click",function(){gkSound.toggleSounds()}),m()):(localStorage.musicStatus="on",h=!0)},hasMP3Support:function(){var a=document.createElement("audio");return!(!a.canPlayType||!a.canPlayType("audio/mpeg;").replace(/no/,""))},hasOGGSupport:function(){var a=document.createElement("audio");return!(!a.canPlayType||!a.canPlayType("audio/ogg;").replace(/no/,""))},addSound:function(c,d,e,f,g){var h=function(){1==f&&(0==e?gkSound.playTrack():gkSound.playTrack())},i=function(a){void 0!=g&&g(a)};if(n(c))i({message:"Sound already exists.",code:-1});else{var j=new Audio(o(d));j.setAttribute("id",c),e?(j.setAttribute("loop","loop"),b.push(j)):a.push(j),document.getElementById("sounds").appendChild(j),j.addEventListener("canplaythrough",function(){h(),i({message:"Sound loaded.",code:0})},!1),j.addEventListener("error",function(){gkSound.removeSound(c),i({message:"Error! For more information see http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#dom-media-error",code:j.error.code})},!1)}},removeSound:function(c){for(var d=0,e=void 0;void 0==e||a.length>d;)a[d].id==c&&(e=a[d],a.splice(d,1)),d++;for(d=0;void 0==e||b.length>d;)b[d].id==c&&(e=b[d],b.splice(d,1)),d++;return void 0==e?{message:"Sound not exists.",code:-1}:(e.parentNode.removeChild(e),{message:"Sound removed.",code:0})},playSound:function(a,b,c){var d=document.getElementById(a),e=function(a){void 0!=c&&c(a)},f=function(){d.removeEventListener("ended",f),d.playing=!1,e({message:"Sound played.",code:0})};if(h){if(b)try{d.play(),d.currentTime=0}catch(g){d.play()}else d.play();d.playing=!0,d.addEventListener("ended",f,!1)}else e({message:"Sound was muted.",code:-1})},playAllSounds:function(){for(var a=c.length-1;a>=0;a--)document.getElementById(c[a]).play()},pauseSound:function(a){document.getElementById(a).pause()},pauseAllSounds:function(){null!=e&&(gkSound.pauseSound(e),c.push(e));for(var b=a.length-1;b>=0;b--)gkSound.pauseSound(a[b].id),1==document.getElementById(a[b].id).playing&&c.push(a[b].id)},stopSound:function(a){var b=document.getElementById(a);try{b.play(),b.currentTime=0,b.pause()}catch(c){b.pause()}},stopAllSounds:function(){null!=e&&(gkSound.stopSound(e),e=null);for(var b=a.length-1;b>=0;b--)gkSound.stopSound(a[b].id)},playTrack:function(){if(h)for(var a=b.length-1;a>=0;a--){document.getElementById(b[a].id).play(),e=b[a].id;break}},stopTrack:function(){null!=e&&(gkSound.stopSound(e),e=null)},toggleSounds:function(){"mute"==localStorage.musicStatus?(h=!0,localStorage.musicStatus="on",document.getElementById(g).innerHTML=i,gkSound.playTrack()):(h=!1,localStorage.musicStatus="mute",document.getElementById(g).innerHTML=j,gkSound.stopAllSounds())},setGlobalVolume:function(c,e){var f;e=e?!0:!1,d=c;for(var g=a.length-1;g>=0;g--)f=e===!0?a[g].volume*d:c,a[g].volume=f;for(var g=b.length-1;g>=0;g--)f=e===!0?b[g].volume*d:c,b[g].volume=f},getGlobalVolume:function(){return d},setVolume:function(a,b,c){c=void 0==c?!1:!0;var e=c===!0?b*d:b;document.getElementById(a).volume=e},getVolume:function(a){return document.getElementById(a).volume}}}();